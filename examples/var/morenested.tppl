function flip(p) {
  sample(bernoulli(p))
}

a1 = log(10.5) // 10.5 = sqrt(0.25*12^2+0.25*15^2+0.5*6^2)
a2 = log(8.00)

w1   = log(2)
w11  = log(3)
w111 = log(4)
w112 = log(5)
w12  = log(6)
w2   = log(7)
w21  = log(8)

if flip(0.5) then {
  weight(w1+a1)
  resample()
  if flip(0.5) then {
    weight(w11-a1)
    if flip(0.5) then {
      weight(w111)
    } else {
      weight(w112)
    }
  } else {
    weight(w12-a1)
  }
} else {
  weight(w2+a2)
  resample()
  weight(w21-a2)
}
