// Tests pattern matching

// Constant patterns
utest (match () with | () -> true)              true;
utest (match 'c' with | 'c' -> true)            true;
utest (match "string" with | "string" -> true)  true;
utest (match 1 with | 1 -> true)                true;
utest (match 1.0 with | 1.0 -> true)            true;

// Computations in match and res
utest (match 1+2*3 with | 7 -> 1+2*3)           7;

// Record patterns
utest (match {a:1, b:2, c:3} with | {a} -> a)   1;
utest (match {a:1, b:2, c:3} with | {a:d} -> d) 1;
utest (match {a:1, b:2, c:3} with
        | {b,c:d} -> (d,b))                     (3,2);

// List patterns
utest (match [1,2,[3]] with
        | [] -> false
        | head : tail -> (head,tail))           (1, [2,[3]]);
utest (match [1,2,3] with
        | e1 : e2 : e3 : [] -> (e1,e2,e3))      (1,2,3);

// Tuple patterns
utest (match (1,2,(3,4)) with
        | (a,b) -> false
        | (a,b,c) -> (c,b,a))                   ((3,4),2,1);
